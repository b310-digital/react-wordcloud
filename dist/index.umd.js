!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("lodash.debounce"),require("react"),require("d3-selection"),require("resize-observer-polyfill"),require("d3-transition"),require("d3-array"),require("d3-cloud"),require("lodash.clonedeep"),require("seedrandom"),require("tippy.js"),require("d3-dispatch"),require("d3-scale"),require("d3-scale-chromatic")):"function"==typeof define&&define.amd?define(["exports","lodash.debounce","react","d3-selection","resize-observer-polyfill","d3-transition","d3-array","d3-cloud","lodash.clonedeep","seedrandom","tippy.js","d3-dispatch","d3-scale","d3-scale-chromatic"],e):e((t||self).reactWordcloud={},t.debounce,t.react,t.d3Selection,t.resizeObserverPolyfill,0,t.d3Array,t.d3Cloud,t.clonedeep,t.seedrandom,t.tippy,t.d3Dispatch,t.d3Scale,t.d3ScaleChromatic)}(this,function(t,e,n,r,o,a,i,l,u,s,c,f,d,h){function y(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var p=/*#__PURE__*/y(e),x=/*#__PURE__*/y(n),m=/*#__PURE__*/y(o),v=/*#__PURE__*/y(l),g=/*#__PURE__*/y(u),b=/*#__PURE__*/y(s),w=/*#__PURE__*/y(c);function z(){return z=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},z.apply(this,arguments)}var M=Math.PI/180,k=64,S=2048;function q(){var t=[256,256],e=W,n=O,r=j,o=T,a=T,i=C,l=A,u=R,s=[],c=Infinity,d=f.dispatch("word","end"),h=Math.random,y={},p=F,x=!1;function m(e,n,r){for(var o,a,i,l,s,c=n.x,f=n.y,d=Math.sqrt(t[0]*t[0]+t[1]*t[1]),y=u(t),p=h()<.5?1:-1,x=-p;(o=y(x+=p))&&(a=~~o[0],i=~~o[1],!(Math.min(Math.abs(a),Math.abs(i))>=d));)if(n.x=c+a,n.y=f+i,!(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>t[0]||n.y+n.y1>t[1]||r&&I(n,e,t[0])||r&&!((l=n).x+l.x1>(s=r)[0].x&&l.x+l.x0<s[1].x&&l.y+l.y1>s[0].y&&l.y+l.y0<s[1].y))){for(var m,v=n.sprite,g=n.width>>5,b=t[0]>>5,w=n.x-(g<<4),z=127&w,M=32-z,k=n.y1-n.y0,S=(n.y+n.y0)*b+(w>>5),q=0;q<k;q++){m=0;for(var W=0;W<=g;W++)e[S+W]|=m<<M|(W<g?(m=v[q*g+W])>>>z:0);S+=b}return delete n.sprite,!0}return!1}return y.canvas=function(t){return arguments.length?(p=L(t),y):p},y.start=function(){var u=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1).data.length>>2);t.width=(k<<5)/e,t.height=S/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(p()),c=new Uint32Array((t[0]>>5)*t[1]),f=null,v=[],g=s.map(function(t,u){return t.text=e.call(this,t,u),t.font=n.call(this,t,u),t.style=o.call(this,t,u),t.weight=a.call(this,t,u),t.rotate=i.call(this,t,u),t.size=~~r.call(this,t,u),t.padding=l.call(this,t,u),t}).sort(function(t,e){return e.size-t.size});function b(e){var n=50*e,r=Math.min(50*(e+1),s.length);!function(e,n){for(var r=e;r<n;r+=1){var o=g[r];o.x=t[0]*(h()+.5)>>1,o.y=t[1]*(h()+.5)>>1,E(u,o,g,r),o.hasText&&m(c,o,f)&&(v.push(o),d.call("word",y,o),f?D(f,o):f=[{x:o.x+o.x0,y:o.y+o.y0},{x:o.x+o.x1,y:o.y+o.y1}],o.x-=t[0]>>1,o.y-=t[1]>>1)}}(n,r),x||(r<s.length?setTimeout(function(){return b(e+1)},0):(y.stop(),d.call("end",y,v,f)))}return setTimeout(function(){return b(0)},0),y},y.revive=function(){return x=!1,y},y.stop=function(){return x=!0,y},y.timeInterval=function(t){return arguments.length?(c=null==t?Infinity:t,y):c},y.words=function(t){return arguments.length?(s=t,y):s},y.size=function(e){return arguments.length?(t=[+e[0],+e[1]],y):t},y.font=function(t){return arguments.length?(n=L(t),y):n},y.fontStyle=function(t){return arguments.length?(o=L(t),y):o},y.fontWeight=function(t){return arguments.length?(a=L(t),y):a},y.rotate=function(t){return arguments.length?(i=L(t),y):i},y.text=function(t){return arguments.length?(e=L(t),y):e},y.spiral=function(t){return arguments.length?(u=P[t]||t,y):u},y.fontSize=function(t){return arguments.length?(r=L(t),y):r},y.padding=function(t){return arguments.length?(l=L(t),y):l},y.random=function(t){return arguments.length?(h=t,y):h},y.on=function(){var t=d.on.apply(d,arguments);return t===d?y:t},y}function W(t){return t.text}function O(){return"serif"}function T(){return"normal"}function j(t){return Math.sqrt(t.value)}function C(){return 30*(~~(6*Math.random())-3)}function A(){return 1}function E(t,e,n,r){if(!e.sprite){var o=t.context,a=t.ratio;o.clearRect(0,0,(k<<5)/a,S/a);var i=0,l=0,u=0,s=n.length;for(--r;++r<s;){e=n[r],o.save(),o.font=e.style+" "+e.weight+" "+~~((e.size+1)/a)+"px "+e.font;var c=o.measureText(e.text+"m").width*a,f=e.size<<1;if(e.rotate){var d=Math.sin(e.rotate*M),h=Math.cos(e.rotate*M),y=c*h,p=c*d,x=f*h,m=f*d;c=Math.max(Math.abs(y+m),Math.abs(y-m))+31>>5<<5,f=~~Math.max(Math.abs(p+x),Math.abs(p-x))}else c=c+31>>5<<5;if(f>u&&(u=f),i+c>=k<<5&&(i=0,l+=u,u=0),l+f>=S)break;o.translate((i+(c>>1))/a,(l+(f>>1))/a),e.rotate&&o.rotate(e.rotate*M),o.fillText(e.text,0,0),e.padding&&(o.lineWidth=2*e.padding,o.strokeText(e.text,0,0)),o.restore(),e.width=c,e.height=f,e.xoff=i,e.yoff=l,e.x1=c>>1,e.y1=f>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,i+=c}for(var v=o.getImageData(0,0,(k<<5)/a,S/a).data,g=[];--r>=0;)if((e=n[r]).hasText){for(var b=(c=e.width)>>5,w=(f=e.y1-e.y0,0);w<f*b;w++)g[w]=0;if(null==(i=e.xoff))return;l=e.yoff;for(var z=0,q=-1,W=0;W<f;W++){for(w=0;w<c;w++){var O=v[(l+W)*(k<<5)+(i+w)<<2]?1<<31-w%32:0;g[b*W+(w>>5)]|=O,z|=O}z?q=W:(e.y0++,f--,W--,l++)}e.y1=e.y0+q,e.sprite=g.slice(0,(e.y1-e.y0)*b)}}}function I(t,e,n){for(var r,o=t.sprite,a=t.width>>5,i=t.x-(a<<4),l=127&i,u=32-l,s=t.y1-t.y0,c=(t.y+t.y0)*(n>>=5)+(i>>5),f=0;f<s;f++){r=0;for(var d=0;d<=a;d++)if((r<<u|(d<a?(r=o[f*a+d])>>>l:0))&e[c+d])return!0;c+=n}return!1}function D(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function R(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function F(){return document.createElement("canvas")}function L(t){return"function"==typeof t?t:function(){return t}}var P={archimedean:R,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var o=t<0?-1:1;switch(Math.sqrt(1+4*o*t)-o&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};function H(t,e){return t[Math.floor(e()*t.length)]}function N(t){return t.size+"px"}function U(t){return t.text}function V(t){return"translate("+t.x+", "+t.y+")"+("number"==typeof t.rotate?"rotate("+t.rotate+")":"")}function B(t){var e,n=t.callbacks,r=t.maxWords,o=t.options,a=t.selection,l=t.size,u=o.deterministic,s=o.enableOptimizations,c=o.fontFamily,f=o.fontStyle,h=o.fontSizes,y=o.fontWeight,p=o.padding,x=o.randomSeed,m=o.rotations,M=o.rotationAngles,k=o.spiral,S=o.scale,W=t.words.concat().sort(function(t,e){return i.descending(t.value,e.value)}).slice(0,r),O=b.default(u?x||"deterministic":null);(e=s?q():v.default()).size(l).padding(p).words(g.default(W)).rotate(function(){return void 0===m?30*(~~(6*O())-3):function(t,e,n){if(t<1)return 0;var r=[];if(1===t)r=[e[0]];else{r=[].concat(e);for(var o=(e[1]-e[0])/(t-1),a=e[0]+o;a<e[1];)r.push(a),a+=o}return H(r,n)}(m,M,O)}).spiral(k).random(O).text(U).font(c).fontStyle(f).fontWeight(y),function t(r,l){void 0===l&&(l=1),s&&e.revive(),e.fontSize(function(t){var e=function(t,e,n){var r,o=i.min(t,function(t){return Number(t.value)}),a=i.max(t,function(t){return Number(t.value)});switch(n){case"log":r=d.scaleLog;break;case"sqrt":r=d.scaleSqrt;break;default:r=d.scaleLinear}return r().domain([o,a]).range(e)}(W,r,S);return e(t.value)}).on("end",function(e){if(W.length!==e.length&&l<=10){10===l&&console.warn("Unable to layout "+(W.length-e.length)+" word(s) after "+l+" attempts.  Consider: (1) Increasing the container/component size. (2) Lowering the max font size. (3) Limiting the rotation angles.");var i=Math.max(.95*r[0],1);t([i,Math.max(.95*r[1],i)],l+1)}else!function(t){var e,n=t.callbacks,r=t.options,o=t.random,a=t.words,i=n.getWordColor,l=n.getWordTooltip,u=n.onWordClick,s=n.onWordMouseOver,c=n.onWordMouseOut,f=r.colors,d=r.enableTooltip,h=r.fontStyle,y=r.fontWeight,p=r.textAttributes,x=r.tooltipOptions,m=r.fontFamily,v=r.transitionDuration;function g(t){return i?i(t):H(f,o)}t.selection.selectAll("text").data(a).join(function(t){var n=t.append("text").on("click",function(t,e){u&&u(e,t)}).on("mouseover",function(t,n){!d||e&&!e.isDestroyed||(e=w.default(t.target,z({animation:"scale",arrow:!0,content:function(){return l(n)},onHidden:function(t){t.destroy(),e=null}},x))),s&&s(n,t)}).on("mouseout",function(t,n){e&&!e.state.isVisible&&e.destroy(),c&&c(n,t)}).attr("cursor",u?"pointer":"default").attr("fill",g).attr("font-family",m).attr("font-style",h).attr("font-weight",y).attr("text-anchor","middle").attr("transform","translate(0, 0) rotate(0)");"object"==typeof p&&Object.keys(p).forEach(function(t){n=n.attr(t,p[t])}),n=n.call(function(t){return t.transition().duration(v).attr("font-size",N).attr("transform",V).text(U)})},function(t){t.transition().duration(v).attr("fill",g).attr("font-family",m).attr("font-size",N).attr("transform",V).text(U)},function(t){t.transition().duration(v).attr("fill-opacity",0).remove()})}({callbacks:n,options:o,random:O,selection:a,words:e})}).start()}(h)}var G=["callbacks","maxWords","minSize","options","size","words"],J={getWordTooltip:function(t){return t.text+" ("+t.value+")"}},K={colors:i.range(20).map(function(t){return t.toString()}).map(d.scaleOrdinal(h.schemeCategory10)),deterministic:!1,enableOptimizations:!1,enableTooltip:!0,fontFamily:"times new roman",fontSizes:[4,32],fontStyle:"normal",fontWeight:"normal",padding:1,rotationAngles:[-90,90],scale:"sqrt",spiral:"rectangular",tooltipOptions:{},transitionDuration:600};function Q(t){var e=t.callbacks,o=t.maxWords,a=void 0===o?100:o,i=t.minSize,l=t.options,u=t.size,s=t.words,c=function(t,e){if(null==t)return{};var n,r,o={},a=Object.keys(t);for(r=0;r<a.length;r++)e.indexOf(n=a[r])>=0||(o[n]=t[n]);return o}(t,G),f=function(t,e,o){var a=n.useRef(),i=n.useState(e),l=i[0],u=i[1],s=n.useState(null),c=s[0],f=s[1];return n.useEffect(function(){var n=a.current,i=r.select(n).append("svg").style("display","block");"object"==typeof o&&Object.keys(o).forEach(function(t){i=i.attr(t,o[t])});var l=i.append("g");function s(t,e){i.attr("height",e).attr("width",t),l.attr("transform","translate("+t/2+", "+e/2+")"),u([t,e])}f(l);var c=0,d=0;void 0===e?(c=n.parentElement.offsetWidth,d=n.parentElement.offsetHeight):(c=e[0],d=e[1]),s(c=Math.max(c,t[0]),d=Math.max(d,t[1]));var h=new m.default(function(t){if(t&&0!==t.length&&void 0===e){var n=t[0].contentRect;s(n.width,n.height)}});return h.observe(n),function(){h.unobserve(n),r.select(n).selectAll("*").remove()}},[e,t,o]),[a,c,l]}(i,u,l.svgAttributes),d=f[0],h=f[1],y=f[2],v=n.useRef(p.default(B,100));return n.useEffect(function(){if(h){var t=z({},J,e),n=z({},K,l);v.current({callbacks:t,maxWords:a,options:n,selection:h,size:y,words:s})}},[a,e,l,h,y,s]),/*#__PURE__*/x.default.createElement("div",z({ref:d,style:{height:"100%",width:"100%"}},c))}Q.defaultProps={callbacks:J,maxWords:100,minSize:[300,300],options:K},t.ReactWordCloud=Q,t.defaultCallbacks=J,t.defaultOptions=K});
//# sourceMappingURL=index.umd.js.map
